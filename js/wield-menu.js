jQuery(document).ready(function(a){var b=a("#menu-to-edit")[0],c=new MutationObserver(function(b){b.forEach(function(b){var c=b.addedNodes;if(null!==c){var d=a(c);d.each(function(){new menuLevel(a(this)).makeCollapseable().changeMenuItem()})}a(".menu-item").each(function(){var b=new menuLevel(a(this));b.notFollowedBy()})})});a(".menu-item").each(function(){var b=new menuLevel(a(this)).makeCollapseable().changeMenuItem();a(this).find(".collapser").addClass("is-collapsed").parent().nextUntil(".menu-item-depth-0").hide(),b.notFollowedBy()});var d={childList:!0};c.observe(b,d),a(document).on("click",".collapser",function(){var b=new menuLevel(a(this).parent());if(!a(this).hasClass("is-disabled")){if(a(this).hasClass("is-collapsed"))a(this).parent().nextUntil(".menu-item-depth-"+b.depth(),".menu-item-depth-"+(b.depth()+1)).show();else{var c=a(this).parent().nextUntil(".menu-item-depth-"+b.depth());a.each(c,function(c,d){var e="menu-item-depth-[0-"+b.depth()+"]";a(d).attr("class").match(e)||a(d).find(".collapser").addClass("is-collapsed").parent().hide()})}a(this).toggleClass("is-collapsed")}})});var menuLevel=function(a){this.$item=a;var b=jQuery;this.changeMenuItem=function(){if(0===this.$item.children(".menu-item-bar").find(".item-delete").length){this.$item.find(".menu-item-handle");var a=this.$item.find(b(".item-delete")).clone();a.css({display:"inline","float":"none","margin-left":"10px"}).appendTo(this.$item.find(".item-title"))}return this},this.makeCollapseable=function(){return this.$item.prepend(b("<span>").addClass("collapser")),this},this.notFollowedBy=function(){return 0===this.$item.next(".menu-item-depth-"+(this.depth()+1)).length?this.$item.find(".collapser").addClass("is-disabled is-collapsed"):(this.$item.find(".collapser").removeClass("is-disabled"),this.$item.next(".menu-item-depth-"+(this.depth()+1)).is(":visible")&&this.$item.find(".collapser").removeClass("is-collapsed")),this},this.depth=function(){var a=this.$item.attr("class").split(" "),c=0,d=null;return b.each(a,function(a,e){if(d=b.trim(e).match(/^menu-item-depth-(\d)$/))return c=d[1],!1}),parseInt(c,10)}};